# Prospector Scanner Configuration - Updated for split keyboard battery display

# Scanner Mode Configuration
CONFIG_PROSPECTOR_MODE_SCANNER=y

# Bluetooth Configuration
CONFIG_BT=y
CONFIG_BT_OBSERVER=y

# Display Configuration
CONFIG_ZMK_DISPLAY=y
CONFIG_DISPLAY=y

# LVGL Configuration
CONFIG_LVGL=y

# Enable larger fonts for better readability
CONFIG_LV_FONT_MONTSERRAT_12=y
CONFIG_LV_FONT_MONTSERRAT_16=y  
CONFIG_LV_FONT_MONTSERRAT_18=y
CONFIG_LV_FONT_MONTSERRAT_20=y
CONFIG_LV_FONT_MONTSERRAT_22=y
CONFIG_LV_FONT_MONTSERRAT_24=y
CONFIG_LV_FONT_MONTSERRAT_28=y

# Enable Unscii pixel fonts for retro style
CONFIG_LV_FONT_UNSCII_8=y
CONFIG_LV_FONT_UNSCII_16=y

# Prospector Features
CONFIG_PROSPECTOR_USE_AMBIENT_LIGHT_SENSOR=y  # Re-enabled with fixes
CONFIG_PROSPECTOR_MULTI_KEYBOARD=y
CONFIG_PROSPECTOR_MAX_KEYBOARDS=2

# Layer Display Configuration
# Adjust this value based on your keyboard's layer count
# Range: 4-10 layers. Set to highest layer number + 1
# Examples: 6-layer keyboard → set to 6, 8-layer keyboard → set to 8
CONFIG_PROSPECTOR_MAX_LAYERS=7

# Ambient light sensor settings (optional customization)
# Temporarily disable ALS to prevent debug widget overwrites
# CONFIG_PROSPECTOR_USE_AMBIENT_LIGHT_SENSOR=n
# Brightness range settings - minimum brightness (1-95%, default: 10%)
CONFIG_PROSPECTOR_ALS_MIN_BRIGHTNESS=5

# NEW: Separate battery/USB maximum brightness settings
# Battery max: 5-50% range
CONFIG_PROSPECTOR_ALS_MAX_BRIGHTNESS_BATTERY=50
# USB max: 5-90% range
CONFIG_PROSPECTOR_ALS_MAX_BRIGHTNESS_USB=90
# When both are set to 0, uses CONFIG_PROSPECTOR_ALS_MAX_BRIGHTNESS or defaults

# Legacy single max setting (overridden by above if both are non-zero)
# CONFIG_PROSPECTOR_ALS_MAX_BRIGHTNESS=70           # Single max for both power sources

# Update interval (500-10000ms, default: 2000ms)
# Increased to 10s to reduce debug widget overwrites during battery investigation
CONFIG_PROSPECTOR_ALS_UPDATE_INTERVAL_MS=10000

# Light sensor sensitivity adjustment (v1.1.0 feature)
# Reduce sensitivity: higher values need brighter light for 100% brightness
CONFIG_PROSPECTOR_ALS_SENSOR_THRESHOLD=200

# Fixed brightness mode (when ALS disabled)
# CONFIG_PROSPECTOR_USE_AMBIENT_LIGHT_SENSOR=n  # Disable ALS for fixed brightness

# NEW: Separate battery/USB fixed brightness settings
# Battery fixed: 40%
CONFIG_PROSPECTOR_FIXED_BRIGHTNESS_BATTERY=40
# USB fixed: 85%
CONFIG_PROSPECTOR_FIXED_BRIGHTNESS_USB=85
# When both are set to 0, uses CONFIG_PROSPECTOR_FIXED_BRIGHTNESS or defaults

# Legacy single fixed setting (overridden by above if both are non-zero)
# CONFIG_PROSPECTOR_FIXED_BRIGHTNESS=70           # Single fixed for both power sources

# Smooth fade settings for better battery operation
# Fade duration (100-5000ms, default: 1000ms)
CONFIG_PROSPECTOR_BRIGHTNESS_FADE_DURATION_MS=1500
# Fade steps (5-50, default: 10)
CONFIG_PROSPECTOR_BRIGHTNESS_FADE_STEPS=15

# Scanner timeout - extended for battery operation (8 minutes)
# For testing, you can set a shorter timeout like 30000ms (30 seconds)
CONFIG_PROSPECTOR_SCANNER_TIMEOUT_MS=480000

# Battery operation power saving settings
# Auto-dim display when keyboards go idle (2 minutes)
CONFIG_PROSPECTOR_SCANNER_IDLE_BRIGHTNESS_MS=120000
CONFIG_PROSPECTOR_SCANNER_IDLE_BRIGHTNESS_PERCENT=20

# Advertisement frequency-based dimming
CONFIG_PROSPECTOR_ADVERTISEMENT_FREQUENCY_DIM=y
CONFIG_PROSPECTOR_ADV_FREQUENCY_DIM_THRESHOLD_MS=2000
CONFIG_PROSPECTOR_ADV_FREQUENCY_DIM_BRIGHTNESS=25

# APDS9960 Sensor Driver (required for ambient light sensor)
CONFIG_SENSOR=y
CONFIG_APDS9960=y
CONFIG_I2C=y

# Disable unused features
CONFIG_ZMK_SPLIT=n

# Disable serial/USB features that are causing Kconfig warnings
CONFIG_SERIAL=n
CONFIG_UART_CONSOLE=n
CONFIG_USB_CDC_ACM=n

# Enable debug logging only (without serial console)
CONFIG_LOG=y
CONFIG_ZMK_LOG_LEVEL_DBG=y
CONFIG_LOG_MODE_IMMEDIATE=y

# Note: USB serial debugging is not available in scanner mode
# Use visual debugging - watch display brightness changes
# Or use hardware debugger (J-Link/ST-Link) for RTT

# YADS-style modifier detection and NerdFont display
# Build trigger: Compilation error fix (function forward declaration)
# Resolves battery periodic update work queue definition order
# Updated Wed Aug  7 2025

# Scanner Battery Support (v1.2 development)
# Enable scanner's own battery monitoring and display
# CONFIG_PROSPECTOR_BATTERY_SUPPORT=y
# CONFIG_PROSPECTOR_BATTERY_SHOW_PERCENTAGE=y
# CONFIG_PROSPECTOR_BATTERY_WIDGET_POSITION="TOP_RIGHT"

# Battery Widget Production Mode (with real battery hardware)
CONFIG_PROSPECTOR_BATTERY_SUPPORT=y
# CONFIG_PROSPECTOR_BATTERY_DEMO_MODE=y  # Disabled for production use

# Battery update interval: 2 minutes for normal operation
CONFIG_PROSPECTOR_BATTERY_UPDATE_INTERVAL_S=120

# Required dependencies for battery support (to avoid Kconfig circular dependencies)
CONFIG_ZMK_BATTERY_REPORTING=y
CONFIG_USB_DEVICE_STACK=y

# Investigation: More frequent ZMK battery report for hardware reading analysis
CONFIG_ZMK_BATTERY_REPORT_INTERVAL=30

# Debug Widget Configuration (v1.1 development)
# Debug widget disabled for production use - battery issue resolved
# CONFIG_PROSPECTOR_DEBUG_WIDGET=y

# Note: Battery support is disabled by default since no battery hardware is currently connected.
# For UI testing: Enable DEMO_MODE. For real use: Add 400mAh LiPo battery hardware.

